import{L as k}from"./leaflet-56e24ed8.js";import{_ as B}from"./index-f7af34a6.js";import{S as f,W as g,R as m,m as h,V as d,a1 as C,F as O,_ as R,X as l,a0 as T,$ as D,o as N,U as F,O as M,a3 as $}from"./@vue-2f237c7b.js";import{T as j}from"./TextField-77495f70.js";import{v as U}from"./uuid-cf522c50.js";import"./vue-router-e91cc718.js";import"./mitt-f7ef348c.js";import"./vuetify-b250ab63.js";/* empty css             */import"./axios-17b187b0.js";var A=function(){this._tweens={},this._tweensAddedDuringUpdate={}};A.prototype={getAll:function(){return Object.keys(this._tweens).map((function(t){return this._tweens[t]}).bind(this))},removeAll:function(){this._tweens={}},add:function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},remove:function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},update:function(t,e){var s=Object.keys(this._tweens);if(s.length===0)return!1;for(t=t!==void 0?t:c.now();s.length>0;){this._tweensAddedDuringUpdate={};for(var n=0;n<s.length;n++){var a=this._tweens[s[n]];a&&a.update(t)===!1&&(a._isPlaying=!1,e||delete this._tweens[s[n]])}s=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var c=new A;c.Group=A,c._nextId=0,c.nextId=function(){return c._nextId++},typeof window>"u"&&typeof process<"u"?c.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:typeof window<"u"&&window.performance!==void 0&&window.performance.now!==void 0?c.now=window.performance.now.bind(window.performance):Date.now!==void 0?c.now=Date.now:c.now=function(){return new Date().getTime()},c.Tween=function(t,e){this._object=t,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._repeatDelayTime=void 0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._easingFunction=c.Easing.Linear.None,this._interpolationFunction=c.Interpolation.Linear,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onCompleteCallback=null,this._onStopCallback=null,this._group=e||c,this._id=c.nextId()},c.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},to:function(t,e){return this._valuesEnd=t,e!==void 0&&(this._duration=e),this},start:function(t){this._group.add(this),this._isPlaying=!0,this._onStartCallbackFired=!1,this._startTime=t!==void 0?typeof t=="string"?c.now()+parseFloat(t):t:c.now(),this._startTime+=this._delayTime;for(var e in this._valuesEnd){if(this._valuesEnd[e]instanceof Array){if(this._valuesEnd[e].length===0)continue;this._valuesEnd[e]=[this._object[e]].concat(this._valuesEnd[e])}this._object[e]!==void 0&&(this._valuesStart[e]=this._object[e],!(this._valuesStart[e]instanceof Array)&&(this._valuesStart[e]*=1),this._valuesStartRepeat[e]=this._valuesStart[e]||0)}return this},stop:function(){return this._isPlaying?(this._group.remove(this),this._isPlaying=!1,this._onStopCallback!==null&&this._onStopCallback(this._object),this.stopChainedTweens(),this):this},end:function(){return this.update(this._startTime+this._duration),this},stopChainedTweens:function(){for(var t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop()},group:function(t){return this._group=t,this},delay:function(t){return this._delayTime=t,this},repeat:function(t){return this._repeat=t,this},repeatDelay:function(t){return this._repeatDelayTime=t,this},yoyo:function(t){return this._yoyo=t,this},easing:function(t){return this._easingFunction=t,this},interpolation:function(t){return this._interpolationFunction=t,this},chain:function(){return this._chainedTweens=arguments,this},onStart:function(t){return this._onStartCallback=t,this},onUpdate:function(t){return this._onUpdateCallback=t,this},onComplete:function(t){return this._onCompleteCallback=t,this},onStop:function(t){return this._onStopCallback=t,this},update:function(t){var e,s,n;if(t<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback!==null&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),s=(t-this._startTime)/this._duration,s=this._duration===0||s>1?1:s,n=this._easingFunction(s);for(e in this._valuesEnd)if(this._valuesStart[e]!==void 0){var a=this._valuesStart[e]||0,i=this._valuesEnd[e];i instanceof Array?this._object[e]=this._interpolationFunction(i,n):(typeof i=="string"&&(i=i.charAt(0)==="+"||i.charAt(0)==="-"?a+parseFloat(i):parseFloat(i)),typeof i=="number"&&(this._object[e]=a+(i-a)*n))}if(this._onUpdateCallback!==null&&this._onUpdateCallback(this._object),s===1){if(this._repeat>0){isFinite(this._repeat)&&this._repeat--;for(e in this._valuesStartRepeat){if(typeof this._valuesEnd[e]=="string"&&(this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(this._valuesEnd[e])),this._yoyo){var o=this._valuesStartRepeat[e];this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=o}this._valuesStart[e]=this._valuesStartRepeat[e]}return this._yoyo&&(this._reversed=!this._reversed),this._repeatDelayTime!==void 0?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime,!0}this._onCompleteCallback!==null&&this._onCompleteCallback(this._object);for(var r=0,u=this._chainedTweens.length;r<u;r++)this._chainedTweens[r].start(this._startTime+this._duration);return!1}return!0}},c.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return .5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return t===0?0:Math.pow(1024,t-1)},Out:function(t){return t===1?1:1-Math.pow(2,-10*t)},InOut:function(t){return t===0?0:t===1?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return t===0?0:t===1?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return t===0?0:t===1?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return t===0?0:t===1?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){return t*t*(2.70158*t-1.70158)},Out:function(t){return--t*t*(2.70158*t+1.70158)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-c.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*c.Easing.Bounce.In(2*t):.5*c.Easing.Bounce.Out(2*t-1)+.5}}},c.Interpolation={Linear:function(t,e){var s=t.length-1,n=s*e,a=Math.floor(n),i=c.Interpolation.Utils.Linear;return e<0?i(t[0],t[1],n):e>1?i(t[s],t[s-1],s-n):i(t[a],t[a+1>s?s:a+1],n-a)},Bezier:function(t,e){for(var s=0,n=t.length-1,a=Math.pow,i=c.Interpolation.Utils.Bernstein,o=0;o<=n;o++)s+=a(1-e,n-o)*a(e,o)*t[o]*i(n,o);return s},CatmullRom:function(t,e){var s=t.length-1,n=s*e,a=Math.floor(n),i=c.Interpolation.Utils.CatmullRom;return t[0]===t[s]?(e<0&&(a=Math.floor(n=s*(1+e))),i(t[(a-1+s)%s],t[a],t[(a+1)%s],t[(a+2)%s],n-a)):e<0?t[0]-(i(t[0],t[0],t[1],t[1],-n)-t[0]):e>1?t[s]-(i(t[s],t[s],t[s-1],t[s-1],n-s)-t[s]):i(t[a?a-1:0],t[a],t[s<a+1?s:a+1],t[s<a+2?s:a+2],n-a)},Utils:{Linear:function(t,e,s){return(e-t)*s+t},Bernstein:function(t,e){var s=c.Interpolation.Utils.Factorial;return s(t)/s(e)/s(t-e)},Factorial:function(){var t=[1];return function(e){var s=1;if(t[e])return t[e];for(var n=e;n>1;n--)s*=n;return t[e]=s,s}}(),CatmullRom:function(t,e,s,n,a){var i=.5*(s-t),o=.5*(n-e),r=a*a;return(2*e-2*s+i+o)*(a*r)+(-3*e+3*s-2*i-o)*r+i*a+e}}},function(t){typeof define=="function"&&define.amd?define([],function(){return c}):typeof module<"u"&&typeof exports=="object"?module.exports=c:t!==void 0&&(t.TWEEN=c)}(globalThis);L.Curve=L.Path.extend({options:{},initialize:function(t,e){L.setOptions(this,e),this._setPath(t)},setLatLngs:function(t){return this.setPath(t)},_updateBounds:function(){var t=this._clickTolerance(),e=new L.Point(t,t);this._pxBounds=new L.Bounds([this._rawPxBounds.min.subtract(e),this._rawPxBounds.max.add(e)])},getPath:function(){return this._coords},setPath:function(t){return this._setPath(t),this.redraw()},getBounds:function(){return this._bounds},_setPath:function(t){this._coords=t,this._bounds=this._computeBounds()},_computeBounds:function(){for(var t=new L.LatLngBounds,e,s,n,a=0;a<this._coords.length;a++)if(n=this._coords[a],typeof n=="string"||n instanceof String)s=n;else if(s=="H")t.extend([e.lat,n[0]]),e=new L.latLng(e.lat,n[0]);else if(s=="V")t.extend([n[0],e.lng]),e=new L.latLng(n[0],e.lng);else if(s=="C"){var i=new L.latLng(n[0],n[1]);n=this._coords[++a];var o=new L.latLng(n[0],n[1]);n=this._coords[++a];var r=new L.latLng(n[0],n[1]);t.extend(i),t.extend(o),t.extend(r),r.controlPoint1=i,r.controlPoint2=o,e=r}else if(s=="S"){if(o=new L.latLng(n[0],n[1]),n=this._coords[++a],r=new L.latLng(n[0],n[1]),i=e,e.controlPoint2){var u=e.lat-e.controlPoint2.lat,p=e.lng-e.controlPoint2.lng;i=new L.latLng(e.lat+u,e.lng+p)}t.extend(i),t.extend(o),t.extend(r),r.controlPoint1=i,r.controlPoint2=o,e=r}else if(s=="Q"){var v=new L.latLng(n[0],n[1]);n=this._coords[++a],r=new L.latLng(n[0],n[1]),t.extend(v),t.extend(r),r.controlPoint=v,e=r}else s=="T"?(r=new L.latLng(n[0],n[1]),v=e,e.controlPoint&&(u=e.lat-e.controlPoint.lat,p=e.lng-e.controlPoint.lng,v=new L.latLng(e.lat+u,e.lng+p)),t.extend(v),t.extend(r),r.controlPoint=v,e=r):(t.extend(n),e=new L.latLng(n[0],n[1]));return t},getCenter:function(){return this._bounds.getCenter()},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._usingCanvas?this._updateCurveCanvas():this._updateCurveSvg()},_project:function(){var t,e,s,n;this._points=[];for(var a=0;a<this._coords.length;a++)if(t=this._coords[a],typeof t=="string"||t instanceof String)this._points.push(t),s=t;else{switch(t.length){case 2:n=this._map.latLngToLayerPoint(t),e=t;break;case 1:s=="H"?(n=this._map.latLngToLayerPoint([e[0],t[0]]),e=[e[0],t[0]]):(n=this._map.latLngToLayerPoint([t[0],e[1]]),e=[t[0],e[1]]);break}this._points.push(n)}if(this._bounds.isValid()){var i=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),o=this._map.latLngToLayerPoint(this._bounds.getSouthEast());this._rawPxBounds=new L.Bounds(i,o),this._updateBounds()}},_curvePointsToPath:function(t){for(var e,s,n="",a=0;a<t.length;a++)if(e=t[a],typeof e=="string"||e instanceof String)s=e,n+=s;else switch(s){case"H":n+=e.x+" ";break;case"V":n+=e.y+" ";break;default:n+=e.x+","+e.y+" ";break}return n||"M0 0"},beforeAdd:function(t){L.Path.prototype.beforeAdd.call(this,t),this._usingCanvas=this._renderer instanceof L.Canvas,this._usingCanvas&&(this._pathSvgElement=document.createElementNS("http://www.w3.org/2000/svg","path"))},onAdd:function(t){if(this._usingCanvas&&(this._canvasSetDashArray=!this.options.dashArray),L.Path.prototype.onAdd.call(this,t),this._usingCanvas)this.options.animate&&typeof TWEEN=="object"?(this._normalizeCanvasAnimationOptions(),this._tweenedObject={offset:this._pathSvgElement.getTotalLength()},this._tween=new TWEEN.Tween(this._tweenedObject).to({offset:0},this.options.animate.duration).delay(this.options.animate.delay).repeat(this.options.animate.iterations-1).onComplete(function(s){return function(){s._canvasAnimating=!1}}(this)).start(),this._canvasAnimating=!0,this._animateCanvas()):this._canvasAnimating=!1;else if(this.options.animate&&this._path.animate){var e=this._svgSetDashArray();this._path.animate([{strokeDashoffset:e},{strokeDashoffset:0}],this.options.animate)}},_updateCurveSvg:function(){this._renderer._setPath(this,this._curvePointsToPath(this._points)),this.options.animate&&this._svgSetDashArray()},_svgSetDashArray:function(){var t=this._path,e=t.getTotalLength();return this.options.dashArray||(t.style.strokeDasharray=e+" "+e),e},_containsPoint:function(t){return this._bounds.contains(this._map.layerPointToLatLng(t))},_normalizeCanvasAnimationOptions:function(){var t={delay:0,duration:0,iterations:1};typeof this.options.animate=="number"?t.duration=this.options.animate:(this.options.animate.duration&&(t.duration=this.options.animate.duration),this.options.animate.delay&&(t.delay=this.options.animate.delay),this.options.animate.iterations&&(t.iterations=this.options.animate.iterations)),this.options.animate=t},_updateCurveCanvas:function(){var t=this._curvePointsToPath(this._points);this._pathSvgElement.setAttribute("d",t),this.options.animate&&typeof TWEEN=="object"&&this._canvasSetDashArray&&(this.options.dashArray=this._pathSvgElement.getTotalLength()+"",this._renderer._updateDashArray(this)),this._curveFillStroke(new Path2D(t),this._renderer._ctx)},_animateCanvas:function(){TWEEN.update(),this._renderer._updatePaths(),this._canvasAnimating&&(this._animationFrameId=L.Util.requestAnimFrame(this._animateCanvas,this))},_curveFillStroke:function(t,e){e.lineDashOffset=this._canvasAnimating?this._tweenedObject.offset:0;var s=this.options;s.fill&&(e.globalAlpha=s.fillOpacity,e.fillStyle=s.fillColor||s.color,e.fill(t,s.fillRule||"evenodd")),s.stroke&&s.weight!==0&&(e.setLineDash&&e.setLineDash(this.options&&this.options._dashArray||[]),e.globalAlpha=s.opacity,e.lineWidth=s.weight,e.strokeStyle=s.color,e.lineCap=s.lineCap,e.lineJoin=s.lineJoin,e.stroke(t))},trace:function(t){if(this._map===void 0||this._map===null)return[];t=t.filter(function(v){return v>=0&&v<=1});for(var e,s,n,a,i,o,r,u=[],p=0;p<this._points.length;p++)if(e=this._points[p],typeof e=="string"||e instanceof String)s=e,s=="Z"&&(u=u.concat(this._linearTrace(t,a,n)));else switch(s){case"M":n=e,a=e;break;case"L":case"H":case"V":u=u.concat(this._linearTrace(t,a,e)),a=e;break;case"C":i=e,o=this._points[++p],r=this._points[++p],u=u.concat(this._cubicTrace(t,a,i,o,r)),a=r;break;case"S":i=this._reflectPoint(o,a),o=e,r=this._points[++p],u=u.concat(this._cubicTrace(t,a,i,o,r)),a=r;break;case"Q":i=e,o=this._points[++p],u=u.concat(this._quadraticTrace(t,a,i,o)),a=o;break;case"T":i=this._reflectPoint(i,a),o=e,u=u.concat(this._quadraticTrace(t,a,i,o)),a=o;break}return u},_linearTrace:function(t,e,s){return t.map(n=>{var a=this._singleLinearTrace(n,e.x,s.x),i=this._singleLinearTrace(n,e.y,s.y);return this._map.layerPointToLatLng([a,i])})},_quadraticTrace:function(t,e,s,n){return t.map(a=>{var i=this._singleQuadraticTrace(a,e.x,s.x,n.x),o=this._singleQuadraticTrace(a,e.y,s.y,n.y);return this._map.layerPointToLatLng([i,o])})},_cubicTrace:function(t,e,s,n,a){return t.map(i=>{var o=this._singleCubicTrace(i,e.x,s.x,n.x,a.x),r=this._singleCubicTrace(i,e.y,s.y,n.y,a.y);return this._map.layerPointToLatLng([o,r])})},_singleLinearTrace:function(t,e,s){return e+t*(s-e)},_singleQuadraticTrace:function(t,e,s,n){var a=1-t;return Math.pow(a,2)*e+2*a*t*s+Math.pow(t,2)*n},_singleCubicTrace:function(t,e,s,n,a){var i=1-t;return Math.pow(i,3)*e+3*Math.pow(i,2)*t*s+3*i*Math.pow(t,2)*n+Math.pow(t,3)*a},_reflectPoint:function(t,e){return x=e.x+(e.x-t.x),y=e.y+(e.y-t.y),L.point(x,y)}});L.curve=function(t,e){return new L.Curve(t,e)};const z={name:"HomeXMap",data(){return{map:null}},mounted(){setTimeout(()=>{this.map=k.map("mapContainer").setView([35.796198683501956,51.417160039142345],17),k.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(this.map);var t=this.map.createPane("customPane");k.canvas({pane:"customPane"}),t.style.zIndex=399;var e=k.marker([35.79767659207426,51.416657591801254],{draggable:!0}).addTo(this.map);e.on("dragend",function(s){var n=s.target,a=n.getLatLng();console.log("Marker dragged to:",a)})},100)},methods:{}},V={id:"mapContainer",class:"h-[91dvh] w-full"};function H(t,e,s,n,a,i){return f(),g("div",V)}const q=B(z,[["render",H]]),W={props:["chatData"],setup(t){const e=ref(t.chatData.messages),s=ref(""),n=ref({}),a=ref(!1),i=ref(!1),o=ref(""),r=ref("");return{months:reactive(["Junuary","February","March","April","May","June","July","August","September","October","November","December"]),interval:s,messages:e,replyMessage:n,showGoDownBtn:a,hasNewMessage:i,repliedMessageID:o,boldMessageStyle:r}},mounted(){this.emitter.emit("doScrollToEnd"),this.emitter.on("showRepliedMessage",t=>{this.showMessage(t)})},methods:{formattedDate(t){let e=t.split("-")[0],s=Number(t.split("-")[1]),n=Number(t.split("-")[2]);return this.months[s]+" "+n+", "+e},goToDate(t){document.getElementById(t).scrollIntoView({behavior:"smooth",block:"start"})},doReplyMessage(t){this.$emit("doReply",t)},showMessage(t){setTimeout(()=>{this.repliedMessageID=t,document.getElementById(t)&&(document.getElementById(t).scrollIntoView({behavior:"smooth",block:"start"}),this.boldMessageStyle="background-color: #c8d3eb48; border-radius:10px; transition: .3s linear;",clearInterval(this.interval),this.interval=setInterval(()=>{this.boldMessageStyle="background-color: transparent;transition: .3s linear;"},2e3))},400)},computedMessageTime(t,e){return t[Number(e)+1]&&t[Number(e)+1].senderName==t[Number(e)].senderName?t[Number(e)+1].time!=t[Number(e)].time:!0},messageDirection(t){if(t){var e=/[\u0591-\u07FF]/;return e.test(t)?"rtl":"ltr"}else return"ltr"},removeBrTags(t){if(t)return t.replaceAll("<br>"," ")},computedGoDownButton(){var t=document.querySelector(".chat_content");parseInt(t.scrollTop)<t.scrollHeight-t.offsetHeight-parseInt(t.getBoundingClientRect().height/5)?this.showGoDownBtn=!0:(this.showGoDownBtn=!1,this.hasNewMessage=!1)}}};const Q=W,G={key:0,class:"absolute top-[50%] left-[50%] translate-x-[-50%] translate-y-[-50%]"},J=l("span",{class:"text-grey"},"There are no messages yet...",-1),X=["id"],Y={class:"text-xs"},Z=["id"],K=["onClick"],tt={class:"message_sender mb-0"},et=["dir"],st={class:"d-flex",style:{"align-items":"center"}},nt=["dir","innerHTML"],at={class:"d-flex flex-column justify-end"},it={key:0,class:"pl-4"},ot=["onClick"],rt=l("span",{class:"text-[0.9rem]"},"Reply",-1),lt={class:"pa-2 d-flex align-center hover:bg-[#ebebeb] rounded-md cursor-pointer"},ct=l("span",{class:"text-[0.9rem]"},"Copy",-1),ht={class:"pa-2 d-flex align-center hover:bg-[#ebebeb] rounded-md cursor-pointer"},ut=l("span",{class:"text-[0.9rem]"},"Delete",-1);function dt(t,e,s,n,a,i){const o=m("v-chip"),r=m("v-spacer"),u=m("v-icon"),p=m("v-card"),v=m("v-menu"),S=m("v-col"),I=m("v-row");return f(),g("div",{class:"chat_content relative",onScroll:e[0]||(e[0]=b=>t.computedGoDownButton())},[t.chatData&&t.chatData.messages&&!t.chatData.messages.length?(f(),g("div",G,[h(o,{small:""},{default:d(()=>[J]),_:1})])):C("",!0),(f(!0),g(O,null,R(t.messages,(b,w)=>(f(),g("div",{class:"messages_by_date text-center",key:w,id:b.date},[h(o,{small:"",onClick:_=>t.goToDate(b.date),class:"date_chip text-white sticky top-[10px] z-10 my-4"},{default:d(()=>[l("span",Y,T(t.formattedDate(b.date)),1)]),_:2},1032,["onClick"]),(f(!0),g(O,null,R(b.messages,(_,E)=>(f(),g("div",{key:E,id:_.id},[h(I,{onDblclick:P=>t.doReplyMessage(_)},{default:d(()=>[h(S,{class:"py-1"},{default:d(()=>[l("div",{style:$(_.id==t.repliedMessageID?t.boldMessageStyle:"")},[h(v,{location:_.self?"start":"end"},{activator:d(({props:P})=>[l("div",{class:D(["w-fit",_.self?"ml-auto":"mr-auto"])},[l("div",{class:D(["message_box w-fit min-w-[50px] max-w-[300px] text-[0.83rem] text-left mt-1",{own_message:_.self,user_message:!_.self,"mb-1.5":!t.computedMessageTime(b.messages,E)}])},[_.repliedMessage&&_.repliedMessage.text?(f(),g("div",{key:0,class:"replied_message cursor-pointer text-left",onClick:Bt=>t.showMessage(_.repliedMessage.id)},[l("p",tt,T(_.repliedMessage.senderName),1),l("p",{class:"message_text mb-0",dir:t.messageDirection(_.repliedMessage.text)},T(_.repliedMessage.text.length>30?`${t.removeBrTags(_.repliedMessage.text).slice(0,30)}...`:t.removeBrTags(_.repliedMessage.text)),9,et)],8,K)):C("",!0),l("div",N(P,{class:"d-flex"}),[l("div",st,[l("span",{dir:t.messageDirection(_.text),innerHTML:_.text,class:"text-left"},null,8,nt)]),h(r),l("div",at,[_.self?(f(),g("span",it,[l("div",null,[_.seen?(f(),F(u,{key:0,size:"sm",color:"#fff"},{default:d(()=>[M("mdi-check-all")]),_:1})):(f(),F(u,{key:1,size:"sm",color:"#fff"},{default:d(()=>[M("mdi-check")]),_:1}))])])):C("",!0)])],16)],2),t.computedMessageTime(b.messages,E)?(f(),g("div",{key:0,class:D(["text-xs text-grey my-1",_.self?" text-right":"text-left"]),style:{"user-select":"none"}},T(_.time),3)):C("",!0)],2)]),default:d(()=>[h(p,{class:"pa-2 rounded-lg"},{default:d(()=>[l("div",{class:"pa-2 d-flex align-center hover:bg-[#ebebeb] rounded-md cursor-pointer",onClick:P=>t.doReplyMessage(_)},[h(u,{icon:"svg:reply",size:"small",class:"mr-2"}),rt],8,ot),l("div",lt,[h(u,{icon:"svg:copy",size:"small",class:"mr-2"}),ct]),l("div",ht,[h(u,{icon:"svg:trash",size:"small",class:"mr-2"}),ut])]),_:2},1024)]),_:2},1032,["location"])],4)]),_:2},1024)]),_:2},1032,["onDblclick"])],8,Z))),128))],8,X))),128))],32)}const _t=B(Q,[["render",dt]]);const pt={name:"ChatId",components:{Map:q,TextField:j,ChatContent:_t},setup(){const t=ref(null),e=ref({}),s=ref(!1),n=ref(!1),a=ref(!1),i=ref(""),o=ref({}),r=ref(!1);return{map:t,chatData:e,hasReply:s,isLoaded:n,mapDialog:a,messageField:i,smoothScroll:r,selectedMessage:o}},created(){this.getData();const t=s=>{const n=s.coords.latitude;s.coords.longitude,console.log(n)},e=s=>{console.log("error")};navigator.geolocation.getCurrentPosition(t,e)},mounted(){this.emitter.on("doScrollToEnd",()=>{this.scrollToEnd()}),setTimeout(()=>{this.smoothScroll=!0},1e3)},onBeforeUnmount(){this.map&&this.map.remove()},methods:{getData(){this.$http.get("/static/api/chats.json",{headers:{Authorization:"Bearer: "+localStorage.getItem("token")}}).then(t=>{this.chatData=t.data.chats.filter(e=>e.id==this.$route.params.id)[0],setTimeout(()=>{this.isLoaded=!0},200)}).catch(t=>{console.log(t)})},currentTime(){let t=new Date,e,s;return e=("0"+t.getHours()).slice(-2),s=("0"+t.getMinutes()).slice(-2),e+":"+s},currentDate(){let t=new Date,e=String(t.getDate()).padStart(2,"0"),s=String(t.getMonth()).padStart(2,"0");return t.getFullYear()+"-"+s+"-"+e},scrollToEnd(){var t=document.querySelector(".chat_body"),e=t.scrollHeight;t.scrollTop=e},sendMessage(){let t={id:U(),self:!0,senderName:"You",text:this.parsedText,time:this.currentTime(),repliedMessage:this.hasReply?this.selectedMessage:{}};if(this.chatData.messages.length){let e=this.chatData.messages.length-1;this.currentDate()==this.chatData.messages[e].date?this.chatData.messages[e].messages.push(t):this.chatData.messages.push({date:this.currentDate(),messages:[t]})}else this.chatData.messages.push({date:this.currentDate(),messages:[t]});this.hasReply=!1,this.messageField="",this.selectedMessage={},document.getElementById("message_field").focus(),setTimeout(()=>{this.scrollToEnd()},5)},doReply(t){this.hasReply=!0,this.selectedMessage=t,document.getElementById("message_field").focus(),setTimeout(()=>{this.scrollToEnd()},10)},closeReply(){this.hasReply=!1,this.selectedMessage=""},showMessage(t){this.emitter.emit("showRepliedMessage",t)},removeBrTags(t){if(t)return t.replaceAll("<br>"," ")},doScroll(){setTimeout(()=>{this.scrollToEnd()},500)},openMapDialog(){this.mapDialog=!0}},computed:{parsedText(){return this.messageField.replace(/\n/g,"<br>")}}},ft={key:0,class:"chat_id"},mt={class:"pa-4 pt-1 bg-[--header-bg] h-[100px] d-flex justify-space-between align-center"},gt={class:"text-center"},vt={class:"text-white text-[18px]"},yt={key:0,class:"text-grey text-sm"},wt={key:1,class:"text-primary text-sm"},bt=["src"],Tt={class:"pa-3 pt-1 bg-white mt-[-12px] rounded-[--md-radius]"},xt={class:"mx-4 text-[0.92rem] w-[75%]"},Mt={class:"text-primary"},Ct={class:"text-sm text-grey text-overflow"},kt={class:"d-flex"},Lt=l("span",{class:"text-sm text-[#868686]"},"Location",-1),Dt={class:"lg:max-w-[400px] mx-auto w-full h-full relative"},St={class:"absolute right-4 bottom-[110px] z-[400]"},It={class:"w-full d-flex gap-x-3 pa-4"},Et=l("div",null,[l("p",{class:"text-[#868686]"},"Send selected location"),l("p",{class:"text-[#868686] text-sm"}," (35.796198683501956, 51.417160039142345) ")],-1);function Pt(t,e,s,n,a,i){const o=m("v-icon"),r=m("v-btn"),u=m("chat-content"),p=m("v-card"),v=m("v-menu"),S=m("v-textarea"),I=m("Map"),b=m("v-dialog");return n.isLoaded?(f(),g("div",ft,[l("div",mt,[h(r,{variant:"tonal",color:"white",width:"45",height:"45",icon:"",onClick:e[0]||(e[0]=w=>t.$router.push("/chats"))},{default:d(()=>[h(o,{class:"white-icon"},{default:d(()=>[M("svg:chevronLeft")]),_:1})]),_:1}),l("div",gt,[l("p",vt,T(n.chatData.chatTitle),1),n.chatData.isOnline?(f(),g("p",wt,"Online")):(f(),g("p",yt,T(n.chatData.lastseen),1))]),l("img",{src:n.chatData.imageUrl,width:"45",height:"45",class:"rounded-full"},null,8,bt)]),l("div",Tt,[h(u,{class:D(["chat_body",{hasReplyBox:n.hasReply,"scroll-smooth":n.smoothScroll}]),chatData:n.chatData,onDoReply:i.doReply},null,8,["class","chatData","onDoReply"]),n.hasReply?(f(),g("div",{key:0,onClick:e[1]||(e[1]=w=>i.showMessage(n.selectedMessage.id)),class:"pa-4 my-2 h-[54px] bg-[--lighten-gray] rounded-[--sm-radius] d-flex align-center justify-space-between shadow-inner"},[l("div",null,[h(o,{size:"large",color:"primary",class:"scale-x-[-1]"},{default:d(()=>[M("mdi-reply")]),_:1})]),l("div",xt,[l("p",Mt,T(n.selectedMessage.senderName),1),l("p",Ct,T(i.removeBrTags(n.selectedMessage.text)),1)]),l("div",null,[h(o,{onClick:i.closeReply,color:"grey"},{default:d(()=>[M("mdi-close")]),_:1},8,["onClick"])])])):C("",!0),l("div",kt,[h(S,{rows:"1","no-resize":"",hideDetails:"",variant:"solo",id:"message_field",placeholder:"Message...",class:"custom_textarea w-full",modelValue:n.messageField,"onUpdate:modelValue":e[3]||(e[3]=w=>n.messageField=w),modelModifiers:{trim:!0},onClick:i.doScroll},{"prepend-inner":d(()=>[h(v,null,{activator:d(({props:w})=>[h(o,N({icon:"svg:attach",class:"mr-2"},w),null,16)]),default:d(()=>[h(p,{class:"pa-3 rounded-lg"},{default:d(()=>[l("div",{onClick:e[2]||(e[2]=w=>i.openMapDialog())},[h(o,{icon:"svg:location",class:"gray-icon mr-1"}),Lt])]),_:1})]),_:1})]),_:1},8,["modelValue","onClick"]),h(r,{onClick:e[4]||(e[4]=w=>n.messageField?i.sendMessage():""),color:"primary",class:"rounded-[10px] ml-2",width:"56",height:"56",icon:"",flat:""},{default:d(()=>[h(o,{class:"white-icon",size:"x-large",icon:"svg:send"})]),_:1})])]),h(b,{modelValue:n.mapDialog,"onUpdate:modelValue":e[5]||(e[5]=w=>n.mapDialog=w),fullscreen:"",scrim:!0,transition:"dialog-bottom-transition"},{default:d(()=>[h(p,null,{default:d(()=>[l("div",Dt,[h(I),l("div",St,[h(r,{icon:"",color:"white",class:"ml-3"},{default:d(()=>[h(o,{class:"gray-icon"},{default:d(()=>[M("svg:currentLocation")]),_:1})]),_:1})]),l("div",It,[h(r,{icon:"",color:"primary",flat:""},{default:d(()=>[h(o,{class:"white-icon"},{default:d(()=>[M("svg:location")]),_:1})]),_:1}),Et])])]),_:1})]),_:1},8,["modelValue"])])):C("",!0)}const Ht=B(pt,[["render",Pt]]);export{Ht as default};
